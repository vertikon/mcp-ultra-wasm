<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCP Ultra WASM Web Interface</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="/static/css/main.css" rel="stylesheet">
    
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        .status-online { background-color: #28a745; }
        .status-offline { background-color: #dc3545; }
        .status-loading { background-color: #ffc107; animation: pulse 1.5s infinite; }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .log-container {
            max-height: 300px;
            overflow-y: auto;
            background: #1e1e1e;
            border-radius: 8px;
            padding: 15px;
        }
        
        .log-entry {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            margin: 2px 0;
            padding: 2px 0;
        }
        
        .log-info { color: #17a2b8; }
        .log-success { color: #28a745; }
        .log-warning { color: #ffc107; }
        .log-error { color: #dc3545; }
        
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .progress-fill {
            transition: width 0.3s ease;
        }
        
        .code-output {
            background: #1e1e1e;
            color: #f8f9fa;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            border-radius: 8px;
            padding: 15px;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        
        .feature-card {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .feature-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .navbar-brand {
            font-weight: 600;
            font-size: 1.4rem;
        }
        
        .loading-spinner {
            display: none;
        }
        
        .loading .loading-spinner {
            display: inline-block;
        }
        
        .loading .btn-text {
            display: none;
        }
    </style>
</head>
<body class="bg-light">
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark gradient-bg shadow-sm">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="bi bi-cpu"></i>
                MCP Ultra WASM
            </a>
            <div class="navbar-nav ms-auto">
                <div class="nav-item">
                    <span class="navbar-text">
                        <span class="status-indicator status-offline" id="connection-status"></span>
                        <span id="connection-text">Offline</span>
                    </span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container-fluid py-4">
        <!-- Header Section -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card border-0 shadow-sm glass-effect">
                    <div class="card-body">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h1 class="h3 mb-2">WebAssembly Interface</h1>
                                <p class="text-muted mb-0">
                                    Execute Go code directly in your browser with native performance
                                </p>
                            </div>
                            <div class="col-md-4 text-md-end">
                                <div class="d-flex align-items-center justify-content-md-end">
                                    <span class="badge bg-success me-2" id="wasm-status">
                                        <i class="bi bi-check-circle"></i> Ready
                                    </span>
                                    <button class="btn btn-outline-primary btn-sm" onclick="window.debugApp()">
                                        <i class="bi bi-bug"></i> Debug
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Features Row -->
        <div class="row mb-4">
            <div class="col-lg-3 col-md-6 mb-3">
                <div class="card feature-card h-100 border-0 shadow-sm">
                    <div class="card-body text-center">
                        <i class="bi bi-search text-primary" style="font-size: 2rem;"></i>
                        <h5 class="card-title mt-2">Analysis</h5>
                        <p class="card-text small text-muted">Analyze Go projects for metrics and insights</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 mb-3">
                <div class="card feature-card h-100 border-0 shadow-sm">
                    <div class="card-body text-center">
                        <i class="bi bi-code-slash text-success" style="font-size: 2rem;"></i>
                        <h5 class="card-title mt-2">Generation</h5>
                        <p class="card-text small text-muted">Generate code from specifications</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 mb-3">
                <div class="card feature-card h-100 border-0 shadow-sm">
                    <div class="card-body text-center">
                        <i class="bi bi-shield-check text-warning" style="font-size: 2rem;"></i>
                        <h5 class="card-title mt-2">Validation</h5>
                        <p class="card-text small text-muted">Validate configurations and deployments</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 mb-3">
                <div class="card feature-card h-100 border-0 shadow-sm">
                    <div class="card-body text-center">
                        <i class="bi bi-gear text-info" style="font-size: 2rem;"></i>
                        <h5 class="card-title mt-2">Processing</h5>
                        <p class="card-text small text-muted">Process custom tasks and operations</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Control Panel and Output -->
        <div class="row">
            <!-- Control Panel -->
            <div class="col-lg-6 mb-4">
                <div class="card border-0 shadow-sm h-100">
                    <div class="card-header bg-white border-bottom">
                        <h5 class="card-title mb-0">
                            <i class="bi bi-sliders"></i>
                            Control Panel
                        </h5>
                    </div>
                    <div class="card-body">
                        <form id="task-form">
                            <!-- Function Selection -->
                            <div class="mb-3">
                                <label for="wasm-function" class="form-label">Select Function</label>
                                <select class="form-select" id="wasm-function">
                                    <option value="analyze">üîç Analyze Project</option>
                                    <option value="generate">‚ö° Generate Code</option>
                                    <option value="validate">‚úÖ Validate Config</option>
                                    <option value="process">‚öôÔ∏è Process Task</option>
                                </select>
                            </div>

                            <!-- Task Configuration -->
                            <div class="mb-3">
                                <label for="task-input" class="form-label">
                                    Task Configuration 
                                    <small class="text-muted">(JSON)</small>
                                </label>
                                <textarea 
                                    class="form-control font-monospace" 
                                    id="task-input" 
                                    rows="8" 
                                    placeholder='Enter project path or configuration to analyze...'
                                    spellcheck="false"></textarea>
                                <div class="form-text">
                                    Press <kbd>Ctrl+Enter</kbd> to execute
                                </div>
                            </div>

                            <!-- Execute Button -->
                            <div class="d-grid gap-2 d-md-flex justify-content-md-start">
                                <button type="button" class="btn btn-primary" id="execute-btn">
                                    <span class="btn-text">
                                        <i class="bi bi-play-fill"></i>
                                        Execute Task
                                    </span>
                                    <span class="loading-spinner">
                                        <span class="spinner-border spinner-border-sm" role="status"></span>
                                        Executing...
                                    </span>
                                </button>
                                <button type="button" class="btn btn-outline-secondary" id="clear-btn">
                                    <i class="bi bi-arrow-clockwise"></i>
                                    Clear
                                </button>
                                <button type="button" class="btn btn-outline-info btn-sm" id="clear-logs-btn">
                                    <i class="bi bi-journal-x"></i>
                                    Clear Logs
                                </button>
                            </div>
                        </form>

                        <!-- Progress Bar -->
                        <div class="mt-3" id="progress-container" style="display: none;">
                            <div class="d-flex justify-content-between mb-1">
                                <span class="small text-muted">Progress</span>
                                <span class="small text-muted" id="progress-text">0%</span>
                            </div>
                            <div class="progress" style="height: 6px;">
                                <div class="progress-bar progress-fill bg-success" 
                                     id="progress-bar" 
                                     role="progressbar" 
                                     style="width: 0%">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Output Panel -->
            <div class="col-lg-6 mb-4">
                <div class="card border-0 shadow-sm h-100">
                    <div class="card-header bg-white border-bottom">
                        <div class="d-flex justify-content-between align-items-center">
                            <h5 class="card-title mb-0">
                                <i class="bi bi-terminal"></i>
                                Output
                            </h5>
                            <div>
                                <span class="badge bg-secondary me-2" id="task-id"></span>
                                <span class="badge bg-primary" id="status-indicator">Ready</span>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="code-output" id="output-content">
                            Waiting for task execution...
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Logs Section -->
        <div class="row">
            <div class="col-12">
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-white border-bottom">
                        <div class="d-flex justify-content-between align-items-center">
                            <h5 class="card-title mb-0">
                                <i class="bi bi-journal-text"></i>
                                System Logs
                            </h5>
                            <button class="btn btn-outline-secondary btn-sm" onclick="window.clearLogs()">
                                <i class="bi bi-trash"></i>
                                Clear Logs
                            </button>
                        </div>
                    </div>
                    <div class="card-body p-0">
                        <div class="log-container" id="log-content">
                            <div class="log-entry log-info">
                                [00:00:00] System initialized. Waiting for WebAssembly module...
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Info Section -->
        <div class="row mt-4">
            <div class="col-md-6">
                <div class="card border-0 shadow-sm">
                    <div class="card-body">
                        <h6 class="card-title">
                            <i class="bi bi-info-circle text-primary"></i>
                            Quick Start
                        </h6>
                        <ol class="small mb-0">
                            <li>Select a function from the dropdown</li>
                            <li>Enter configuration in JSON format</li>
                            <li>Press Execute or Ctrl+Enter</li>
                            <li>View results in the output panel</li>
                        </ol>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card border-0 shadow-sm">
                    <div class="card-body">
                        <h6 class="card-title">
                            <i class="bi bi-lightning text-warning"></i>
                            Example Configurations
                        </h6>
                        <div class="small">
                            <strong>Analysis:</strong><br>
                            <code>{"project_path": "/path/to/go/project", "analysis_type": "full"}</code>
                            <hr class="my-2">
                            <strong>Generation:</strong><br>
                            <code>{"component_type": "service", "name": "UserService", "language": "go"}</code>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-light border-top mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-md-6">
                    <small class="text-muted">
                        ¬© 2025 MCP Ultra WASM - Powered by WebAssembly
                    </small>
                </div>
                <div class="col-md-6 text-md-end">
                    <small class="text-muted">
                        Version <span id="version-info">1.0.0</span> | 
                        <a href="#" onclick="window.showAbout(); return false;">About</a>
                    </small>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Load WASM Loader -->
    <script src="/static/js/wasm-loader.js"></script>
    
    <!-- Load Main Application -->
    <script src="/static/js/main.js"></script>
    
    <script>
        // Global functions for debugging and utilities
        window.showAbout = function() {
            const modal = new bootstrap.Modal(document.getElementById('aboutModal'));
            modal.show();
        };
        
        // Auto-update version info
        document.addEventListener('DOMContentLoaded', function() {
            // Try to get version from WASM module
            if (window.app && window.app.wasmModule) {
                try {
                    const versionInfo = window.app.wasmModule.getVersion();
                    if (versionInfo && versionInfo.version) {
                        document.getElementById('version-info').textContent = versionInfo.version;
                    }
                } catch (error) {
                    console.log('Could not fetch version from WASM:', error);
                }
            }
        });
    </script>
</body>
</html>